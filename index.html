<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è§†é¢‘åˆ†äº«å¹³å°</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Helvetica Neue", Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 10px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .banner-link {
            display: block;
            margin-bottom: 15px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .banner-link img {
            width: 100%;
            display: block;
        }
        
        .player-container {
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
        }
        
        #videoPlayer {
            width: 100%;
            height: 280px;
            display: block;
        }
        
        .player-tip {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin-bottom: 15px;
            padding: 0 10px;
        }
        
        .video-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .video-info h2 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #333;
        }
        
        .video-info p {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .watch-count {
            display: flex;
            align-items: center;
            background: #e3f2fd;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .watch-count .icon {
            width: 24px;
            height: 24px;
            background: #2196f3;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            color: white;
            font-size: 12px;
        }
        
        .video-list {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .video-list h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #ff4081;
        }
        
        .video-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .video-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .video-item:hover {
            background: #f0f0f0;
        }
        
        .video-item.active {
            background: #e3f2fd;
            border-left: 3px solid #2196f3;
        }
        
        .video-item .thumb {
            width: 60px;
            height: 45px;
            background: #ddd;
            border-radius: 4px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 12px;
            overflow: hidden;
        }
        
        .video-item .thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .video-item .info {
            flex-grow: 1;
        }
        
        .video-item .title {
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .video-item .duration {
            font-size: 12px;
            color: #666;
        }
        
        .share-section {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .share-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #ff4081;
        }
        
        .qrcode-container {
            display: flex;
            justify-content: center;
            margin: 15px 0;
        }
        
        .custom-qrcode {
            width: 180px;
            height: 180px;
            border: 1px solid #eee;
            padding: 10px;
            border-radius: 8px;
            background: #f9f9f9;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .custom-qrcode img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .share-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .share-btn {
            flex: 1;
            padding: 10px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            margin: 0 5px;
            cursor: pointer;
        }
        
        .share-btn.wechat {
            background: #09bb07;
        }
        
        .share-btn.moments {
            background: #7bc549;
        }
        
        .options-section {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .options-section h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #ff9800;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .option-item {
            background: #fff3e0;
            border-radius: 6px;
            padding: 12px 8px;
            text-align: center;
            border-left: 3px solid #ff9800;
        }
        
        .option-item .icon {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .option-item .text {
            font-size: 12px;
            color: #333;
        }
        
        .footer {
            text-align: center;
            padding: 15px;
            font-size: 12px;
            color: #999;
            margin-top: 20px;
        }
        
        .locked-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 10;
            border-radius: 8px;
        }
        
        .locked-overlay .lock-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }
        
        .locked-overlay p {
            margin-bottom: 15px;
            text-align: center;
            padding: 0 20px;
        }
        
        .unlock-btn {
            padding: 10px 20px;
            background: #ff4081;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>è§†é¢‘åˆ†äº«å¹³å°</h1>
        <p>ç²¾å½©è§†é¢‘å…è´¹çœ‹ï¼Œåˆ†äº«å¥½å‹è§£é”æ›´å¤š</p>
    </div>
    
    <!-- å¯è‡ªå®šä¹‰çš„è¶…é“¾æ¥å›¾ç‰‡ -->
    <a href="#" class="banner-link">
        <img src="https://via.placeholder.com/500x100/4CAF50/FFFFFF?text=è‡ªå®šä¹‰å¹¿å‘Šå›¾ç‰‡" alt="å¹¿å‘Šå›¾ç‰‡">
    </a>
    
    <div class="player-container">
        <video id="videoPlayer" controls></video>
        
        <div id="lockedOverlay" class="locked-overlay hidden">
            <div class="lock-icon">ğŸ”’</div>
            <p>æ‚¨å·²è§‚çœ‹å®Œ3ä¸ªå…è´¹è§†é¢‘ï¼Œåˆ†äº«ç»™å¥½å‹å³å¯è§£é”æ›´å¤šå†…å®¹</p>
            <button class="unlock-btn" id="showShareBtn">ç«‹å³åˆ†äº«</button>
        </div>
    </div>
    
    <div class="player-tip">
        æ¸©é¦¨æç¤ºï¼šè§†é¢‘åŠ è½½å¯èƒ½éœ€è¦å‡ ç§’é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…
    </div>
    
    <div class="video-info">
        <h2 id="currentVideoTitle">è¯·é€‰æ‹©ä¸€ä¸ªè§†é¢‘æ’­æ”¾</h2>
        <p>é˜²èµ°ä¸¢æç¤ºå¦‚æ— æ³•æ‰“å¼€ï¼Œæ¢ä¸€éƒ¨ä½œå“åˆ†äº«ç»™è£™å‹</p>
        <div class="watch-count">
            <div class="icon">!</div>
            <div>ä»Šæ—¥å·²è§‚çœ‹: <span id="watchedCount">0</span>/3 ä¸ªå…è´¹è§†é¢‘</div>
        </div>
    </div>
    
    <div class="video-list">
        <h3>è§†é¢‘åˆ—è¡¨</h3>
        <div class="video-items" id="videoItems">
            <!-- è§†é¢‘åˆ—è¡¨ä¼šé€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>
    
    <div class="share-section hidden" id="shareSection">
        <h3>åˆ†äº«ç»™å¥½å‹è§£é”æ›´å¤šè§†é¢‘</h3>
        <p>è¯·å°†ä¸‹æ–¹äºŒç»´ç åˆ†äº«ç»™å¥½å‹æˆ–å¾®ä¿¡ç¾¤ï¼Œåˆ†äº«åå³å¯ç»§ç»­è§‚çœ‹</p>
        <div class="qrcode-container">
            <div class="custom-qrcode">
                <!-- æ›¿æ¢ä¸ºæ‚¨çš„äºŒç»´ç å›¾ç‰‡ -->
                <img src="https://ibb.co.com/Z63h8mck" alt="åˆ†äº«äºŒç»´ç ">
            </div>
        </div>
        <div class="share-buttons">
            <button class="share-btn wechat" id="shareToFriend">åˆ†äº«ç»™å¥½å‹</button>
            <button class="share-btn moments" id="shareToGroup">åˆ†äº«åˆ°å¾®ä¿¡ç¾¤</button>
        </div>
        <p style="margin-top: 15px; font-size: 12px; color: #666;">åˆ†äº«åè¯·è¿”å›æ­¤é¡µé¢ï¼Œç‚¹å‡»"æˆ‘å·²åˆ†äº«"æŒ‰é’®</p>
        <button class="unlock-btn" id="confirmShare" style="margin-top: 10px;">æˆ‘å·²åˆ†äº«</button>
    </div>
    
    <div class="options-section">
        <h3>ç²¾é€‰å†…å®¹æ¨è</h3>
        <div class="options-grid">
            <div class="option-item">
                <div class="icon">ğŸ“º</div>
                <div class="text">çƒ­é—¨ç›´æ’­</div>
            </div>
            <div class="option-item">
                <div class="icon">ğŸ¬</div>
                <div class="text">æœ€æ–°å½±è§†</div>
            </div>
            <div class="option-item">
                <div class="icon">ğŸµ</div>
                <div class="text">éŸ³ä¹MV</div>
            </div>
            <div class="option-item">
                <div class="icon">ğŸ®</div>
                <div class="text">æ¸¸æˆè§†é¢‘</div>
            </div>
            <div class="option-item">
                <div class="icon">ğŸ“±</div>
                <div class="text">çŸ­è§†é¢‘</div>
            </div>
            <div class="option-item">
                <div class="icon">ğŸ”¥</div>
                <div class="text">çƒ­é—¨æ¨è</div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>Â© 2025 è§†é¢‘åˆ†äº«å¹³å° Â· ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–å˜é‡
            let watchedCount = 0;
            let hasShared = false;
            const videoPlayer = document.getElementById('videoPlayer');
            const watchedCountElement = document.getElementById('watchedCount');
            const lockedOverlay = document.getElementById('lockedOverlay');
            const shareSection = document.getElementById('shareSection');
            const showShareBtn = document.getElementById('showShareBtn');
            const videoItemsContainer = document.getElementById('videoItems');
            const currentVideoTitle = document.getElementById('currentVideoTitle');
            const shareToFriend = document.getElementById('shareToFriend');
            const shareToGroup = document.getElementById('shareToGroup');
            const confirmShare = document.getElementById('confirmShare');
            
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½è§‚çœ‹æ¬¡æ•°
            const savedWatchedCount = localStorage.getItem('watchedCount');
            if (savedWatchedCount !== null) {
                watchedCount = parseInt(savedWatchedCount);
                watchedCountElement.textContent = watchedCount;
            }
            
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½åˆ†äº«çŠ¶æ€
            const savedHasShared = localStorage.getItem('hasShared');
            if (savedHasShared !== null) {
                hasShared = JSON.parse(savedHasShared);
            }
            
            // åœ¨è¿™é‡Œæ·»åŠ æ‚¨çš„å¤šæ¡M3U8é“¾æ¥
            const videoList = [
                {
                    id: 1,
                    title: "ç¤ºä¾‹è§†é¢‘1 - é£æ™¯æ¬£èµ",
                    url: "https://v202509.fhbbff.com/20251025/YvivGiif/index.m3u8",
                    duration: "5:30",
                    thumbnail: "https://via.placeholder.com/60x45/4CAF50/FFFFFF?text=é£æ™¯"
                },
                {
                    id: 2,
                    title: "ç¤ºä¾‹è§†é¢‘2 - åŠ¨ç‰©ä¸–ç•Œ",
                    url: "https://v202509.fhbbff.com/20251025/KJSSxEk1/index.m3u8",
                    duration: "10:15",
                    thumbnail: "https://via.placeholder.com/60x45/2196F3/FFFFFF?text=åŠ¨ç‰©"
                },
                {
                    id: 3,
                    title: "ç¤ºä¾‹è§†é¢‘3 - ç§‘æŠ€å‰æ²¿",
                    url: "https://v202509.fhbbff.com/20251023/tc19cBGs/index.m3u8",
                    duration: "7:45",
                    thumbnail: "https://via.placeholder.com/60x45/FF9800/FFFFFF?text=ç§‘æŠ€"
                },
                {
                    id: 4,
                    title: "ç¤ºä¾‹è§†é¢‘4 - éŸ³ä¹MV",
                    url: "https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",
                    duration: "4:20",
                    thumbnail: "https://via.placeholder.com/60x45/E91E63/FFFFFF?text=éŸ³ä¹"
                },
                {
                    id: 5,
                    title: "ç¤ºä¾‹è§†é¢‘5 - ä½“è‚²é›†é”¦",
                    url: "https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",
                    duration: "8:50",
                    thumbnail: "https://via.placeholder.com/60x45/795548/FFFFFF?text=ä½“è‚²"
                },
                {
                    id: 6,
                    title: "ç¤ºä¾‹è§†é¢‘6 - ç¾é£Ÿåˆ¶ä½œ",
                    url: "https://mnmedias.api.telequebec.tv/m3u8/29880.m3u8",
                    duration: "12:30",
                    thumbnail: "https://via.placeholder.com/60x45/607D8B/FFFFFF?text=ç¾é£Ÿ"
                }
            ];
            
            // åˆå§‹åŒ–HLSæ’­æ”¾å™¨
            let hls;
            
            // æ¸²æŸ“è§†é¢‘åˆ—è¡¨
            function renderVideoList() {
                videoItemsContainer.innerHTML = '';
                
                videoList.forEach(video => {
                    const videoItem = document.createElement('div');
                    videoItem.className = 'video-item';
                    videoItem.dataset.id = video.id;
                    
                    videoItem.innerHTML = `
                        <div class="thumb">
                            <img src="${video.thumbnail}" alt="${video.title}">
                        </div>
                        <div class="info">
                            <div class="title">${video.title}</div>
                            <div class="duration">${video.duration}</div>
                        </div>
                    `;
                    
                    videoItem.addEventListener('click', function() {
                        // æ£€æŸ¥æ˜¯å¦å·²è¾¾åˆ°è§‚çœ‹é™åˆ¶
                        if (watchedCount >= 3 && !hasShared) {
                            lockedOverlay.classList.remove('hidden');
                            return;
                        }
                        
                        // ç§»é™¤æ‰€æœ‰activeç±»
                        document.querySelectorAll('.video-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        
                        // æ·»åŠ activeç±»åˆ°å½“å‰é¡¹
                        this.classList.add('active');
                        
                        // æ’­æ”¾é€‰ä¸­çš„è§†é¢‘
                        playVideo(video);
                    });
                    
                    videoItemsContainer.appendChild(videoItem);
                });
            }
            
            // æ’­æ”¾è§†é¢‘å‡½æ•°
            function playVideo(video) {
                currentVideoTitle.textContent = video.title;
                
                // å¦‚æœHLSå·²ç»å­˜åœ¨ï¼Œå…ˆé”€æ¯
                if (hls) {
                    hls.destroy();
                }
                
                // åˆå§‹åŒ–HLSæ’­æ”¾å™¨
                if (Hls.isSupported()) {
                    hls = new Hls();
                    hls.loadSource(video.url);
                    hls.attachMedia(videoPlayer);
                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                        videoPlayer.play();
                        
                        // å¢åŠ è§‚çœ‹æ¬¡æ•°
                        if (!hasShared) {
                            watchedCount++;
                            updateWatchedCount();
                            
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            localStorage.setItem('watchedCount', watchedCount);
                        }
                    });
                } else if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                    // åŸç”Ÿæ”¯æŒHLSçš„æµè§ˆå™¨ï¼ˆå¦‚Safariï¼‰
                    videoPlayer.src = video.url;
                    videoPlayer.addEventListener('loadedmetadata', function() {
                        videoPlayer.play();
                        
                        // å¢åŠ è§‚çœ‹æ¬¡æ•°
                        if (!hasShared) {
                            watchedCount++;
                            updateWatchedCount();
                            
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            localStorage.setItem('watchedCount', watchedCount);
                        }
                    });
                }
            }
            
            // æ›´æ–°è§‚çœ‹æ¬¡æ•°
            function updateWatchedCount() {
                watchedCountElement.textContent = watchedCount;
                
                if (watchedCount >= 3 && !hasShared) {
                    // æ˜¾ç¤ºé”å®šè¦†ç›–å±‚
                    lockedOverlay.classList.remove('hidden');
                    videoPlayer.pause();
                } else {
                    lockedOverlay.classList.add('hidden');
                }
            }
            
            // æ˜¾ç¤ºåˆ†äº«åŒºåŸŸ
            showShareBtn.addEventListener('click', function() {
                shareSection.classList.remove('hidden');
            });
            
            // åˆ†äº«ç»™å¥½å‹
            shareToFriend.addEventListener('click', function() {
                alert('è¯·å°†äºŒç»´ç å›¾ç‰‡ä¿å­˜å¹¶åˆ†äº«ç»™å¾®ä¿¡å¥½å‹');
            });
            
            // åˆ†äº«åˆ°å¾®ä¿¡ç¾¤
            shareToGroup.addEventListener('click', function() {
                alert('è¯·å°†äºŒç»´ç å›¾ç‰‡ä¿å­˜å¹¶åˆ†äº«åˆ°å¾®ä¿¡ç¾¤');
            });
            
            // ç¡®è®¤åˆ†äº«
            confirmShare.addEventListener('click', function() {
                alert('åˆ†äº«éªŒè¯æˆåŠŸï¼å·²è§£é”æ‰€æœ‰è§†é¢‘');
                hasShared = true;
                lockedOverlay.classList.add('hidden');
                shareSection.classList.add('hidden');
                
                // ä¿å­˜åˆ†äº«çŠ¶æ€åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('hasShared', JSON.stringify(hasShared));
                
                // å¦‚æœå½“å‰æœ‰è§†é¢‘ï¼Œç»§ç»­æ’­æ”¾
                if (videoPlayer.src) {
                    videoPlayer.play();
                }
            });
            
            // åˆå§‹åŒ–
            renderVideoList();
            updateWatchedCount();
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦æ˜¾ç¤ºé”å®šç•Œé¢
            if (watchedCount >= 3 && !hasShared) {
                lockedOverlay.classList.remove('hidden');
            }
        });
    </script>
</body>
</html>
